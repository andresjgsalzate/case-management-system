"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.roleRoutes = void 0;
const express_1 = require("express");
const RoleController_1 = require("../controllers/RoleController");
const auth_1 = require("../middleware/auth");
const auditMiddleware_1 = require("../middleware/auditMiddleware");
const router = (0, express_1.Router)();
exports.roleRoutes = router;
const roleController = new RoleController_1.RoleController();
router.use(auth_1.authenticateToken);
router.use(auditMiddleware_1.AuditMiddleware.initializeAuditContext);
router.get("/", roleController.getAllRoles.bind(roleController));
router.get("/search", roleController.searchRoles.bind(roleController));
router.get("/stats", roleController.getRoleStats.bind(roleController));
router.get("/:id/permissions", roleController.getRolePermissions.bind(roleController));
router.get("/:id", roleController.getRoleById.bind(roleController));
router.post("/", auditMiddleware_1.AuditMiddleware.auditCreate("roles"), roleController.createRole.bind(roleController));
router.post("/:id/clone", auditMiddleware_1.AuditMiddleware.auditCreate("roles"), roleController.cloneRole.bind(roleController));
router.put("/:id", auditMiddleware_1.AuditMiddleware.auditUpdate("roles"), roleController.updateRole.bind(roleController));
router.put("/:id/permissions", auditMiddleware_1.AuditMiddleware.auditUpdate("roles"), roleController.assignPermissions.bind(roleController));
router.delete("/:id", auditMiddleware_1.AuditMiddleware.auditDelete("roles"), roleController.deleteRole.bind(roleController));
